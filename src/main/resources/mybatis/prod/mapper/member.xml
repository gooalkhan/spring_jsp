<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.spring_jsp.member.MemberMapper">
    <select id="getAll" resultType="com.example.spring_jsp.member.MemberDTO">
        select * from membertbl;
    </select>

    <update id="save">
        insert into membertbl (ID, PW, EMAIL, NAME, JOINDATE)
        values (#{id}, #{pw}, #{email}, #{name}, now());
    </update>

    <update id="createTable">
        CREATE TABLE membertbl (
                                   ID varchar(20) NOT NULL,
                                   PW varchar(100) NOT NULL,
                                   EMAIL varchar(100) NOT NULL,
                                   HASEMAILAUTHED tinyint NOT NULL DEFAULT '0',
                                   NAME varchar(30) NOT NULL,
                                   JOINDATE timestamp NOT NULL,
                                   MODIFYDATE timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
                                   PRIMARY KEY (ID)
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3;
    </update>

    <update id="dropTable">
        drop table if exists membertbl;
    </update>
    
    
    
    
    	<!-- 이 위에는 안 건드리고 밑 내용만 건드림 -->
    
    
    
    
    
    <!-- 기본 membertbl select 구문 -->
	<select id="memberSelect" resultType="com.example.spring_jsp.member.MemberDTO">
		select
		*
		from
		membertbl
	</select>
	
	<!-- 기본 membertbl insert 구문(게시글 등록) -->
	<insert id="memberJoin">
		insert
		into
		membertbl
		(ID, PW, EMAIL, NAME, JOINDATE, MODIFYDATE)
		values
		(#{id}, #{pw}, #{email}, #{name}, now(), now())
	</insert>
	
	<!-- 기본 membertbl update 구문(게시글 수정) -->
	<update id="memberUpdate">
		update membertbl set
		PW = #{pw},
		EMAIL = #{email},
		NAME = #{name},
		MODIFYDATE = now()
		where
		ID = #{id}
	</update>
	
	<!-- 기본 membertbl delete 구문(게시글 삭제) -->
	<delete id="memberDelete">
		delete
		from
		membertbl
		where
		ID = #{id}
	</delete>
	
	<!-- 회원 상세 정보 -->
	<select id="memberDetail" resultType="com.example.spring_jsp.member.MemberDTO">
		<![CDATA[
	    select
	    *
	    from
	    membertbl
	    where
	    ID = #{id}
	    ]]>
	</select>
	
	<!-- 로그인 -->
	<select id="memberLogin" resultType="com.example.spring_jsp.member.MemberDTO">
		<![CDATA[
	    select
	    *
	    from
	    membertbl
	    where
	    ID = #{id}
	    and
	    PW = #{pw}
	    ]]>
	</select>
		
	<!-- 해당 id가 있는지 확인 -->
	<select id="existsById" resultType="com.example.spring_jsp.member.MemberDTO">
		<![CDATA[
	    select
	    *
	    from
	    membertbl
	    where
	    ID = #{id}
	    ]]>
	</select>
	
	<!-- 해당 이름이 있는지 확인 -->
	<select id="existsByName" resultType="com.example.spring_jsp.member.MemberDTO">
		<![CDATA[
	    select
	    *
	    from
	    membertbl
	    where
	    NAME = #{name}
	    ]]>
	</select>
	
	<!-- 해당 이메일이 있는지 확인 -->
	<select id="existsByEmail" resultType="com.example.spring_jsp.member.MemberDTO">
		<![CDATA[
	    select
	    *
	    from
	    membertbl
	    where
	    Email = #{email}
	    ]]>
	</select>
</mapper>